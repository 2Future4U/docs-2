<p>In order to avoid conflicts with your existing ASP.NET web framework it is recommended to host your ServiceStack web services at a custom path.
This will allow you to use ServiceStack together with an existing web framework e.g. ASP.NET MVC 3 or FUBU MVC, etc.</p>

<p>The location configuration (to your root Web.config file) below hosts your webservices at custom path: <code>/api</code></p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">configuration</span>&gt;
  <span class="pl-c">&lt;!-- ... --&gt;</span> 
  &lt;<span class="pl-ent">location</span> <span class="pl-e">path</span>=<span class="pl-s"><span class="pl-pds">"</span>api<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">system</span>.web&gt;
      &lt;<span class="pl-ent">httpHandlers</span>&gt;
        &lt;<span class="pl-ent">add</span> <span class="pl-e">path</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>ServiceStack.HttpHandlerFactory, ServiceStack<span class="pl-pds">"</span></span> <span class="pl-e">verb</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span>/&gt;
      &lt;/<span class="pl-ent">httpHandlers</span>&gt;
    &lt;/<span class="pl-ent">system</span>.web&gt;

    <span class="pl-c">&lt;!-- Required for IIS 7.0 --&gt;</span>
    &lt;<span class="pl-ent">system</span>.webServer&gt;
      &lt;<span class="pl-ent">modules</span> <span class="pl-e">runAllManagedModulesForAllRequests</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>/&gt;
      &lt;<span class="pl-ent">validation</span> <span class="pl-e">validateIntegratedModeConfiguration</span>=<span class="pl-s"><span class="pl-pds">"</span>false<span class="pl-pds">"</span></span> /&gt;
      &lt;<span class="pl-ent">handlers</span>&gt;
        &lt;<span class="pl-ent">add</span> <span class="pl-e">path</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>ServiceStack.Factory<span class="pl-pds">"</span></span> 
             <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>ServiceStack.HttpHandlerFactory, ServiceStack<span class="pl-pds">"</span></span> <span class="pl-e">verb</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span> 
             <span class="pl-e">preCondition</span>=<span class="pl-s"><span class="pl-pds">"</span>integratedMode<span class="pl-pds">"</span></span> <span class="pl-e">resourceType</span>=<span class="pl-s"><span class="pl-pds">"</span>Unspecified<span class="pl-pds">"</span></span> <span class="pl-e">allowPathInfo</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span> /&gt;
      &lt;/<span class="pl-ent">handlers</span>&gt;
    &lt;/<span class="pl-ent">system</span>.webServer&gt;
  &lt;/<span class="pl-ent">location</span>&gt;
  <span class="pl-c">&lt;!-- ... --&gt;</span> 
&lt;/<span class="pl-ent">configuration</span>&gt;</pre></div>

<p>Configuration for also running on Mono / IIS 6:</p>

<div class="highlight highlight-text-xml"><pre><span class="pl-c">&lt;!-- Required for MONO --&gt;</span>
&lt;<span class="pl-ent">configuration</span>&gt;
  <span class="pl-c">&lt;!-- ... --&gt;</span> 
  &lt;<span class="pl-ent">system</span>.web&gt;
    &lt;<span class="pl-ent">httpHandlers</span>&gt;
      &lt;<span class="pl-ent">add</span> <span class="pl-e">path</span>=<span class="pl-s"><span class="pl-pds">"</span>api*<span class="pl-pds">"</span></span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>ServiceStack.HttpHandlerFactory, ServiceStack<span class="pl-pds">"</span></span> <span class="pl-e">verb</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span>/&gt;
    &lt;/<span class="pl-ent">httpHandlers</span>&gt;
  &lt;/<span class="pl-ent">system</span>.web&gt;
  &lt;<span class="pl-ent">system</span>.webServer&gt;
    &lt;<span class="pl-ent">validation</span> <span class="pl-e">validateIntegratedModeConfiguration</span>=<span class="pl-s"><span class="pl-pds">"</span>false<span class="pl-pds">"</span></span> /&gt;
  &lt;/<span class="pl-ent">system</span>.webServer&gt;
  <span class="pl-c">&lt;!-- ... --&gt;</span> 
&lt;/<span class="pl-ent">configuration</span>&gt;</pre></div>

<blockquote>
<p><strong>Note:</strong> Due to limitations in IIS 6 - the <code>/custompath</code> must end with <code>.ashx</code>, e.g: <code>path="api.ashx"</code></p>
</blockquote>

<p>You also need to configure the root path in your AppHost.</p>

<div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span> <span class="pl-k">override</span> <span class="pl-k">void</span> Configure(Container container)
{
    SetConfig(<span class="pl-k">new</span> HostConfig { HandlerFactoryPath = <span class="pl-s"><span class="pl-pds">"</span>api<span class="pl-pds">"</span></span> });
}</pre></div>

<p><strong>To avoid conflicts with ASP.NET MVC add an ignore rule</strong> in <code>Global.asax RegisterRoutes</code> method e.g: <code>routes.IgnoreRoute ("api/{*pathInfo}");</code></p>

<p><strong>For MVC4 applications you also need to unregister WebApi</strong>, by commenting out this line in <code>Global.asax.cs</code>:</p>

<div class="highlight highlight-source-cs"><pre>    <span class="pl-c">//WebApiConfig.Register(GlobalConfiguration.Configuration);</span></pre></div>

<blockquote>
<p><strong>Note:</strong> If you used Nuget to install the bits, remove the original handler from the web.config system.webserver node e.g: </p>
</blockquote>

<div class="highlight highlight-text-xml"><pre>
&lt;<span class="pl-ent">add</span> <span class="pl-e">path</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>ServiceStack.Factory<span class="pl-pds">"</span></span>
    <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>ServiceStack.HttpHandlerFactory, ServiceStack<span class="pl-pds">"</span></span> <span class="pl-e">verb</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span> 
    <span class="pl-e">preCondition</span>=<span class="pl-s"><span class="pl-pds">"</span>integratedMode<span class="pl-pds">"</span></span> <span class="pl-e">resourceType</span>=<span class="pl-s"><span class="pl-pds">"</span>Unspecified<span class="pl-pds">"</span></span> <span class="pl-e">allowPathInfo</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span> /&gt;</pre></div>

<p><strong>Due to Mono bug you need to set up explicitly ASP.NET auth to 'windows' mode</strong> when using ServiceStack auth on Mono, otherwise auth will be always redirected to /login.aspx insted of getting nice 401 (invalid username or password) response.</p>

<p>Add to <code>web.config</code> under <code>system.web</code> section.</p>

<div class="highlight highlight-text-xml"><pre><span class="pl-c">&lt;!-- Required to use ServiceStack auth under Mono --&gt;</span>
&lt;<span class="pl-ent">authentication</span> <span class="pl-e">mode</span>=<span class="pl-s"><span class="pl-pds">"</span>Windows<span class="pl-pds">"</span></span> /&gt;</pre></div>

<h3>
<a id="user-content-resources" class="anchor" href="#resources" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Resources</h3>

<ul>
<li><a href="https://github.com/ServiceStackApps/LiveDemos#starter-templates">Example config files for Starter Templates</a></li>
</ul>
